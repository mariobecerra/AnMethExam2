list.of.packages <- c("twitteR", "parallel", "methods")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
lapply(list.of.packages, require, character.only=T)
nc=getOption("mc.cores", 2L)
setup_twitter_oauth('GPI5CNx6tabl6J1M24lQJmCkU', 'YxmKTz1t4uLWSQDKu1h3p0l1g6zSf6PWLPVaAn1ppao23a8ZDY', '86753315-rldhPYu5C17xEzoVMADKNyefqgw1teg0VduH14TVi','Db9volDQ7i0VEjJ85hMHqTQ9nIL1o2w37OJkjAcG1khHz')
users <- read.csv('users_prueba.csv', colClasses = c('factor', 'character'))
users <- users[1:2,]
ids <- users$id
followers <- list() #lista donde se van a guardar todos los followers
followees <- list() #lista donde se van a guardar todos los followees
users <- users[1:4,]
ids <- users$id
followers <- list() #lista donde se van a guardar todos los followers
followees <- list() #lista donde se van a guardar todos los followees
system.time()
sys.time()
Sys.time()
a<-Sys.time()
b<-Sys.time()
a
b
b-a
tic<-Sys.time()
k=0
while(k<3) {
k=k+1
print(k)
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
names(followers2) <- ids
#followees2 <- mclapply(ids, function(i) {getUser(i)$getFriendIDs()}, mc.cores=nc)
followees2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
names(followees2) <- ids
followers <- append(followers, followers2)
followees <- append(followees, followees2)
temp <- unique(c(unlist(followees), unlist(followers)))
ids <- setdiff(temp, ids)
#ids <- ids[1:2]
}
toc<-Sys.time()
followers
ids
ids <- users$id
followers <- list() #lista donde se van a guardar todos los followers
followees <- list() #lista donde se van a guardar todos los followees
tic<-Sys.time()
k=0
while(k<3) {
k=k+1
print(k)
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
names(followers2) <- ids
#followees2 <- mclapply(ids, function(i) {getUser(i)$getFriendIDs()}, mc.cores=nc)
followees2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
names(followees2) <- ids
followers <- append(followers, followers2)
followees <- append(followees, followees2)
temp <- unique(c(unlist(followees), unlist(followers)))
ids <- setdiff(temp, ids)
#ids <- ids[1:2]
}
toc<-Sys.time()
ids
followers
followewrs
followees
i=ids[1]
i
ids <- users$id
i=ids[1]
i
f <- getUser(i)$getFollowerIDs()
f
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
followers2
f
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
ids <- users$id
ids
users <- users[1:4,]
ids <- users$id
ids
users
users <- read.csv('users_prueba.csv', colClasses = c('factor', 'character'))
users <- users[1:4,]
ids <- users$id
ids
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
followers2
f <- getUser(i)$getFollowerIDs()
users <- users[5:6,]
users
users <- read.csv('users_prueba.csv', colClasses = c('factor', 'character'))
users <- users[5:6,]
users
users_seed <- read.csv('users_prueba.csv', colClasses = c('factor', 'character'))
users <- users_seed[5:6,]
ids <- users$id
ids
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
f <- getUser(i)$getFollowerIDs()
followers2 <- lapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()}
)
f <- getUser(i)$getFollowerIDs()
f <- getUser(i)$getFollowerIDs()
f
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
followers2
ids
getUser(71303860)
getUser(71303860)$getFollowerIDs
getUser(71303860)$getFollowerIDs()
f
getUser('mario_becerra')$getFollowerIDs()
getUser('mario_becerra')$getFollowerIDs()
?getUser
sum(getUser('mario_becerra')$getFollowerIDs())
getUser('mario_becerra')$getFollowerIDs()
getUser('mario_becerra')$getFollowerIDs()>0
getUser('mario_becerra')$getFollowerIDs()
ids
followers2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFollowerIDs()
#write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
}, mc.cores=nc)
followers
getUser('mario_becerra')$getFollowerIDs()
i
getUser(i)$getFollowerIDs()
getUser(i)$getFriendIDs()
followees2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
followees2
getUser(i)$getFriendIDs()
#followees2 <- mclapply(ids, function(i) {getUser(i)$getFriendIDs()}, mc.cores=nc)
followees2 <- lapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)})
followees2 <- mclapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)},
mc.cores=nc)
followees2
followees2 <- lapply(ids, function(i) {
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)
})
cbind(getUser(i)$getFriendIDs(), getUser(i)$getFriends())
tUser(i)$getFriends()
getUser(i)$getFriends()
f <- cbind(getUser(i)$getFriends())
f
split(f, factor(f))
write.table(split(f, factor(f)), file='vfdfd')
f
lista <- split(f, factor(f))
mylist <- split(f, factor(f))
sapply(names(mylist),function(x) paste(x,paste(mylist[[x]],collapse=" ")))
sapply(names(mylist),function(x) paste(mylist[[x]],collapse=" "))
write.table(sapply(names(mylist),function(x) paste(mylist[[x]],collapse=" ")), file='pr')
write.table(sapply(names(mylist),function(x) paste(mylist[[x]],collapse=" ")), file='pr', col.names=FALSE)
f <- getUser(i)$getFriends()
f
f.1 <- sapply(names(f),function(x) paste(mylist[[x]],collapse=" "))
f.1
sapply(names(f),function(x) paste(f[[x]],collapse=" "))
names(f)
sapply(names(f), function(x) paste(f[[x]],collapse=" "))
f[[1]]
paste(f[[1]], 5)
as.character(f[[1]])
str(f[[1]])
f[[1]]$name
f[[1]]$screenName
f.1 <- sapply(names(f), function(x) paste(f[[x]]$screenName,collapse=" "))
f.1
write.table(f.1, file=paste0('../Out/', paste(i,'followees.csv')), col.names=FALSE)
?mclapply
followers2 <- lapply(ids, function(i) {
f <- getUser(i)$getFollowers()
f.1 <- sapply(names(f), function(x) paste(f[[x]]$screenName,collapse=" "))
write.table(f.1, file=paste0('../Out/', paste(i,'followers.csv')), col.names=FALSE)
})
f <- getUser(i)$getFriendIDs()
f <- getUser(i)$getFriendIDs()
f
users <- users_seed[1:2,]
ids <- users$id
print(paste('Followers de ',i)
)
print(paste('Followers de ',i))
followers2 <- lapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
})
f
followers2 <- mclapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
})
f <- getUser(i)$getFollowerIDs()
f
followers2 <- lapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
})
followers2
followers2
90/15
f
followers2 <- lapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
})
followers2
followers2 <- lapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
f
})
followers2
names(followers2) <- ids
followers2
followees2 <- lapply(ids, function(i) {
print(paste('Followees de ',i))
f <- getUser(i)$getFriendIDs()
write.table(f, file=paste0('../Out/', paste(i,'followees.csv')), row.names=FALSE, col.names=FALSE)
f
})
followees2
names(followees2) <- ids
followers <- append(followers, followers2)
followees <- append(followees, followees2)
followers
followers <- list() #lista donde se van a guardar todos los followers
followees <- list() #lista donde se van a guardar todos los followees
followers <- append(followers, followers2)
followees <- append(followees, followees2)
followers
temp <- unique(c(unlist(followees), unlist(followers)))
temp
ids <- setdiff(temp, ids)
ids
users
1000/15
1000000/15
*15
1000/60
?getCurRateLimitInfo
getCurRateLimitInfo()
getCurRateLimitInfo()$remaining
getCurRateLimitInfo()$remaining-getCurRateLimitInfo()$limit
as.numeric(getCurRateLimitInfo()$remaining)-as.numeric(getCurRateLimitInfo()$limit)
as.numeric(getCurRateLimitInfo()$remaining)-as.numeric(getCurRateLimitInfo()$limit)
901/60
?Sys.sleep
getCurRateLimitInfo()[52,3]
f <- getUser(i)$getFollowerIDs()
as.numeric(getCurRateLimitInfo()$remaining)-as.numeric(getCurRateLimitInfo()$limit)
getCurRateLimitInfo()
getCurRateLimitInfo()[52,3]
getCurRateLimitInfo()[32,3]
getCurRateLimitInfo()[52,3]
getCurRateLimitInfo()[32,3]
followersfollowing <- list(list(), list())
followersfollowing
names(followersfollowing) <- c('followers', 'following')
followersfollowing
usersfol <- list(list(), list())
names(usersfol) <- c('followers', 'following')
getCurlRate <- getCurRateLimitInfo()
limitfollowers <- getCurlRate[52,3]
limitfollowers
limitfollowing <- getCurRate[32,3]
limitfollowing <- getCurlRate[32,3]
?if
foltemp <- lapply(ids, function(i) {
getCurlRate <- getCurRateLimitInfo()
limitfollowers <- getCurlRate[52,3]
limitfollowing <- getCurlRate[32,3]
if(limitfollowers != 0){
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
} else {
if(limitfollowing !=0){
print(paste('Following de ',i))
g <- getUser(i)$getFriendIDs()
write.table(g, file=paste0('../Out/', paste(i,'following.csv')), row.names=FALSE, col.names=FALSE)
} else {
Sys.sleep(901)
}
}
f
g
})
limitfollowers==0
limitfollowing==0
limitfollowers==0 | limitfollowing==0
foltemp <- lapply(ids, function(i) {
print(paste('Followers de ',i))
f <- getUser(i)$getFollowerIDs()
write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
print(paste('Following de ',i))
g <- getUser(i)$getFriendIDs()
write.table(g, file=paste0('../Out/', paste(i,'following.csv')), row.names=FALSE, col.names=FALSE)
f
g
while(limitfollowers==0 | limitfollowing==0){
Sys.sleep(901)
getCurlRate <- getCurRateLimitInfo()
limitfollowers <- getCurlRate[52,3]
limitfollowing <- getCurlRate[32,3]
}
#     if(limitfollowers != 0){
#       print(paste('Followers de ',i))
#       f <- getUser(i)$getFollowerIDs()
#       write.table(f, file=paste0('../Out/', paste(i,'followers.csv')), row.names=FALSE, col.names=FALSE)
#     } else {
#       if(limitfollowing !=0){
#         print(paste('Following de ',i))
#         g <- getUser(i)$getFriendIDs()
#         write.table(g, file=paste0('../Out/', paste(i,'following.csv')), row.names=FALSE, col.names=FALSE)
#       } else {
#         Sys.sleep(901)
#       }
#     }
#     f
#     g
})
ids
getCurlRate <- getCurRateLimitInfo()
getCurlRate[52,3]
getCurlRate[32,3]
getCurlRate
?grep
